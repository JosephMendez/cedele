"use strict";function ownKeys(t,e){var r,a=Object.keys(t);return Object.getOwnPropertySymbols&&(r=Object.getOwnPropertySymbols(t),e&&(r=r.filter(function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable})),a.push.apply(a,r)),a}function _objectSpread(t){for(var e=1;e<arguments.length;e++){var r=null!=arguments[e]?arguments[e]:{};e%2?ownKeys(Object(r),!0).forEach(function(e){_defineProperty(t,e,r[e])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):ownKeys(Object(r)).forEach(function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(r,e))})}return t}function _defineProperty(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}var styles=[{elementType:"geometry",stylers:[{color:"#ebe3cd"}]},{elementType:"labels.text.fill",stylers:[{color:"#523735"}]},{elementType:"labels.text.stroke",stylers:[{color:"#f5f1e6"}]},{featureType:"administrative",elementType:"geometry.stroke",stylers:[{color:"#c9b2a6"}]},{featureType:"administrative.land_parcel",elementType:"geometry.stroke",stylers:[{color:"#dcd2be"}]},{featureType:"administrative.land_parcel",elementType:"labels.text.fill",stylers:[{color:"#ae9e90"}]},{featureType:"landscape.natural",elementType:"geometry",stylers:[{color:"#dfd2ae"}]},{featureType:"poi",elementType:"geometry",stylers:[{color:"#dfd2ae"}]},{featureType:"poi",elementType:"labels.text.fill",stylers:[{color:"#93817c"}]},{featureType:"poi.park",elementType:"geometry.fill",stylers:[{color:"#a5b076"}]},{featureType:"poi.park",elementType:"labels.text.fill",stylers:[{color:"#447530"}]},{featureType:"road",elementType:"geometry",stylers:[{color:"#f5f1e6"}]},{featureType:"road.arterial",elementType:"geometry",stylers:[{color:"#fdfcf8"}]},{featureType:"road.highway",elementType:"geometry",stylers:[{color:"#f8c967"}]},{featureType:"road.highway",elementType:"geometry.stroke",stylers:[{color:"#e9bc62"}]},{featureType:"road.highway.controlled_access",elementType:"geometry",stylers:[{color:"#e98d58"}]},{featureType:"road.highway.controlled_access",elementType:"geometry.stroke",stylers:[{color:"#db8555"}]},{featureType:"road.local",elementType:"labels.text.fill",stylers:[{color:"#806b63"}]},{featureType:"transit.line",elementType:"geometry",stylers:[{color:"#dfd2ae"}]},{featureType:"transit.line",elementType:"labels.text.fill",stylers:[{color:"#8f7d77"}]},{featureType:"transit.line",elementType:"labels.text.stroke",stylers:[{color:"#ebe3cd"}]},{featureType:"transit.station",elementType:"geometry",stylers:[{color:"#dfd2ae"}]},{featureType:"water",elementType:"geometry.fill",stylers:[{color:"#b9d3c2"}]},{featureType:"water",elementType:"labels.text.fill",stylers:[{color:"#92998d"}]}];!function(){jQuery.fn.inputDropdown=function(){var t=jQuery(this);t.bind("click",function(){t.addClass("opened")}),jQuery(document).click(function(e){!jQuery(e.target).closest(t).length&&t.hasClass("opened")&&t.removeClass("opened")})};function c(e){for(var t=!0,r=(_.sortBy(e),0);r<e.length-1;r++)e[r]+1!=e[r+1]&&(t=!1);return t}jQuery(document).ready(function(){function o(e){var t=e.split(":"),r=(r="".concat(parseInt(t[0])%12))<10&&0<r?"0"+r:r,a=(a="".concat(t[1]))<10&&0<=a&&1===a.length?"0"+a:a;return"".concat(r,":").concat(a).concat(12<parseInt(t[0])?" PM":" AM")}function l(e){var t=e.map(function(e,t){return _objectSpread(_objectSpread({},e),{},{dayIndex:t})}),r=_.groupBy(t,function(e){return[e.start_working_time,e.end_working_time]}),a=[];return _.forEach(r,function(e){return a.push(e)}),_.orderBy(a,function(e){return _.minBy(e,function(e){return e.dayIndex})}),a.map(function(e){return{working_day:(r=(t=e).map(function(e){return e.dayIndex}),1==t.length?n[t[0].working_day]:2!=t.length&&c(r)?c(r)?"".concat(n[t[0].working_day]," - ").concat(n[t[t.length-1].working_day]):void 0:t.map(function(e){return n[e.working_day]}).join(", ")),end_working_time:o(e[0].end_working_time),start_working_time:o(e[0].start_working_time)};var t,r}).map(function(e){return'<p class="mb-0"><span class="text-capitalize">'.concat(e.working_day,"</span>: ").concat(e.start_working_time," to ").concat(e.end_working_time,"</p>")}).join("\n")}function i(){var e=_objectSpread({},s),t=jQuery("#select-outlet").find(":selected").val();"all"!=t&&(e.outlet=t),jQuery.ajax({type:"POST",dataType:"json",url:custom_ajax_vars.ajaxurl,data:Object.assign({action:"list_store"},e),context:this,beforeSend:function(){},success:function(e){var t,n;e.success&&(jQuery(".store-list-wrapper").remove(),jQuery(".store-list").append('<div class="store-list-wrapper cdl-scrollable"></div>'),2<e.data.length?jQuery(".store-list-wrapper").html((t=JSON.parse(e.data),n=jQuery("#store-template").html(),t.map(function(e,t){var r="".concat(e.location.number_house," ").concat(e.location.street_name).concat(e.location.floor_unit||e.location.building?", ".concat(e.location.floor_unit," ").concat(e.location.building):"",", Singapore, ").concat(e.location.zipcode),a=o(e.last_order).startsWith("-")?null:"(Last Order: "+o(e.last_order)+")";return n.format(0==t?"expanded":"",e.location.id,e.location.store_name,e.location.longitude,e.location.latitude,e.location.number_house,e.location.street_name,e.location.floor_unit,e.location.building,e.district,e.area,e.location.phone_number,e.img.length?e.img[0]:"",e.file,e.location.store_name,e.file,r,e.location.phone_number,l(e.working_time),e.location.zipcode,a)}).join("\n"))):jQuery(".store-list-wrapper").html('<div class="no-results">No store found.</div>'),r(),jQuery(".cdl-scrollable").mCustomScrollbar({theme:"dark"}))},error:function(e,t,r){console.log("The following error occured: "+t,r)}})}var s={},y=new GMaps({el:"#map-container",lat:1.2789,lng:103.8536,zoom:12,click:function(){y.hideInfoWindows()}}),n={monday:"Mon",tuesday:"Tue",wednesday:"Wed",thursday:"Thu",friday:"Fri",saturday:"Sat",sunday:"Sun"},r=function(){y&&y.removeMarkers();var u=[];jQuery(".store-card").each(function(){var e,t,r,a,n,o=jQuery(this).attr("data-lat"),l=jQuery(this).attr("data-long"),c=jQuery(this).attr("data-id"),i=jQuery(this),s=u.length;o&&l&&(o=parseFloat(o),l=parseFloat(l),e={lat:o,lng:l,infoWindow:{content:(t=c,r=jQuery("#store-overlay-template").html(),a=jQuery('.store-card[data-id="'.concat(t,'"]')),n="".concat(a.attr("data-number_house")," ").concat(a.attr("data-street_name")).concat(a.attr("data-floor_unit")||a.attr("data-building")?", ".concat(a.attr("data-floor_unit")," ").concat(a.attr("data-building")):"",", Singapore, ").concat(a.attr("data-zipcode")),r.format(a.attr("data-name"),n,a.attr("data-phone_number"),a.attr("data-img"),a.attr("data-file"))),lat:o,lng:l},click:function(){y.hideInfoWindows(),y.setCenter({lat:o,lng:l}),jQuery(".store-card").removeClass("expanded"),jQuery(i).addClass("expanded"),jQuery(i).parent().prepend(i)}},i.click(function(){e.click(),y.markers[s].infoWindow.open(y.map,y.markers[s])}),u.push(e))}),y&&u.length&&(y.addMarkers(u),y.setCenter(u[0])),jQuery(".store-card").first().click()};y.addStyle({styledMapName:"Styled Map",styles:styles,mapTypeId:"map_style"}),y.setStyle("map_style"),jQuery("#select-outlet").on("change",function(){i()}),jQuery(".modal-toggle").click(function(e){e.preventDefault(),jQuery("#location-modal").modal("show");var t=jQuery(e.target).attr("data-selection");jQuery('.nav-tabs a[href="#'+t+'"]').tab("show")}),jQuery(".nav-tabs a.nav-link").on("shown.bs.tab",function(){var e=this;setTimeout(function(){jQuery("#suggestion-input").val().length||("#district"==jQuery(e).attr("href")?(jQuery('[name="select-all-areas"]').prop("checked",!1),jQuery('[name="selected_area[]"]').prop("checked",!1),jQuery('[name="select-all-districts"]').prop("checked",!0),jQuery('[name="selected_district[]"]').prop("checked",!0)):(jQuery('[name="select-all-districts"]').prop("checked",!1),jQuery('[name="selected_district[]"]').prop("checked",!1),jQuery('[name="select-all-areas"]').prop("checked",!0),jQuery('[name="selected_area[]"]').prop("checked",!0)))})}),jQuery("#btn-clear").click(function(e){e.preventDefault(),jQuery(".tab-pane.active").find('input[type="checkbox"]').prop("checked",!1)}),jQuery("#btn-apply").click(function(e){var t;e.preventDefault();var r,a,n=jQuery(".tab-pane.active"),o=jQuery(".tab-pane:not(.active)"),l=n.find('input[type="checkbox"]'),c=n.find('input[type="checkbox"]:checked');c.length&&(l.length==c.length?(t="district"==n.attr("id")?"All Districts":"All Areas",i()):(r=[],a=[],jQuery.each(c,function(){"select-all"!=jQuery(this).attr("data-type")&&(r.push(jQuery(this).attr("data-name")),a.push(jQuery(this).attr("value")))}),t=r.join(", ")),o.find('input[type="checkbox"]').prop("checked",!1),jQuery("#suggestion-input").val(t),jQuery("#reset-filter").removeClass("d-none"),jQuery("#location-modal").modal("hide"),"district"==n.attr("id")?s.district=a.join(","):"area"==n.attr("id")&&(s.area=a.join(",")),i())}),jQuery('input[data-type="select-all"]').on("change",function(){var e=jQuery(this).is(":checked");jQuery(".tab-pane.active").find('input[type="checkbox"]').prop("checked",e)}),jQuery('input[data-type="select-option"]').on("change",function(){jQuery(this).is(":checked");var e=jQuery(".tab-pane.active"),t=e.find('input[data-type="select-option"]'),r=e.find('input[data-type="select-option"]:checked');e.find('input[data-type="select-all"]').prop("checked",t.length==r.length)}),jQuery("#reset-filter").click(function(){jQuery(this).addClass("d-none"),jQuery("#suggestion-input").val(""),jQuery('input[data-type="select-all"]').prop("checked",!0),jQuery('input[data-type="select-option"]').prop("checked",!0),s={},i()}),jQuery(".suggestion-input").inputDropdown(),i()})}();